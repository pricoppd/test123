- name: Retrieve a secret and specific key value
  set_fact:
    specific_key_value: "{{ lookup('hashi_vault', 'secret=bla/joy/secret/kv/paul/secret1:{{ item }} token={{ token }} url={{ host_url }}') }}"
  with_items:
    - githubuser
    - githubpassword
  register: specific_key_value_results

- name: Create a list of key-value pairs
  set_fact:
    key_value_list: []
  run_once: yes

- name: Append key-value pairs to the list
  set_fact:
    key_value_list: "{{ key_value_list + [{'key': specific_key_value_results.results[item_idx].ansible_facts.specific_key_value, 'value': specific_key_value_results.results[item_idx].item}] }}"
  loop: "{{ range(0, specific_key_value_results.results | length) | list }}"
  loop_control:
    index_var: item_idx

- name: Display the key-value list
  debug:
    var: key_value_list
