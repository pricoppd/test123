import os

def combine_text_files_to_txt():
    input_path = os.getcwd()  # Use the current working directory as the input path
    output_file = "combined.txt"

    combined_data = ""

    # List all files in the input path with the .txt extension
    txt_files = [file for file in os.listdir(input_path) if file.endswith(".txt")]

    for txt_file in txt_files:
        file_path = os.path.join(input_path, txt_file)
        if os.path.isfile(file_path):  # Verify that the file exists and is a regular file
            with open(file_path, "r") as f:
                try:
                    file_content = f.read()
                    combined_data += file_content + "\n"
                except Exception as e:
                    print(f"Error: Unable to read data from {txt_file}. Reason: {str(e)}")
        else:
            print(f"Error: {txt_file} is not a valid file.")

    # Write the combined text data to a new text file
    with open(output_file, "w") as f:
        f.write(combined_data)

    # Convert the combined.txt to main.auto.tfvars
    auto_tfvars_file = "main.auto.tfvars"
    auto_tfvars_file_path = os.path.join(input_path, auto_tfvars_file)

    try:
        os.rename(output_file, auto_tfvars_file_path)
        print(f"{output_file} has been converted to {auto_tfvars_file}.")
    except FileNotFoundError:
        print(f"Error: {output_file} not found.")
    except FileExistsError:
        print(f"Error: {auto_tfvars_file} already exists. Please rename or remove it and try again.")

if __name__ == "__main__":
    combine_text_files_to_txt()
