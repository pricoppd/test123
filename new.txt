data "local_file" "conditions" {
  filename = "conditions.json"
}

locals {
  conditions = jsondecode(data.local_file.conditions.content)["stackdriver_alerts"]
}
resource "google_monitoring_alert_policy" "policy" {
  for_each = { for condition in local.conditions : condition.displayName => condition }

  display_name = each.value.displayName
}



########################################################################


resource "google_monitoring_alert_policy" "policy" {
  for_each = { for condition in local.conditions : condition.displayName => condition }

  display_name = each.value.displayName

  dynamic "conditions" {
    for_each = [each.value.conditions] 
    content {
      display_name = conditions.value.displayName
    }
  }
}
